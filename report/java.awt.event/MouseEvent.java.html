<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>MouseEvent.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">java.awt.event</a> &gt; <span class="el_source">MouseEvent.java</span></div><h1>MouseEvent.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1996, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package java.awt.event;

import java.awt.Component;
import java.awt.GraphicsEnvironment;
import java.awt.Point;
import java.awt.Toolkit;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.awt.IllegalComponentStateException;
import java.awt.MouseInfo;
import sun.awt.SunToolkit;

/**
 * An event which indicates that a mouse action occurred in a component.
 * A mouse action is considered to occur in a particular component if and only
 * if the mouse cursor is over the unobscured part of the component's bounds
 * when the action happens.
 * For lightweight components, such as Swing's components, mouse events
 * are only dispatched to the component if the mouse event type has been
 * enabled on the component. A mouse event type is enabled by adding the
 * appropriate mouse-based {@code EventListener} to the component
 * ({@link MouseListener} or {@link MouseMotionListener}), or by invoking
 * {@link Component#enableEvents(long)} with the appropriate mask parameter
 * ({@code AWTEvent.MOUSE_EVENT_MASK} or {@code AWTEvent.MOUSE_MOTION_EVENT_MASK}).
 * If the mouse event type has not been enabled on the component, the
 * corresponding mouse events are dispatched to the first ancestor that
 * has enabled the mouse event type.
 *&lt;p&gt;
 * For example, if a {@code MouseListener} has been added to a component, or
 * {@code enableEvents(AWTEvent.MOUSE_EVENT_MASK)} has been invoked, then all
 * the events defined by {@code MouseListener} are dispatched to the component.
 * On the other hand, if a {@code MouseMotionListener} has not been added and
 * {@code enableEvents} has not been invoked with
 * {@code AWTEvent.MOUSE_MOTION_EVENT_MASK}, then mouse motion events are not
 * dispatched to the component. Instead the mouse motion events are
 * dispatched to the first ancestors that has enabled mouse motion
 * events.
 * &lt;P&gt;
 * This low-level event is generated by a component object for:
 * &lt;ul&gt;
 * &lt;li&gt;Mouse Events
 *     &lt;ul&gt;
 *     &lt;li&gt;a mouse button is pressed
 *     &lt;li&gt;a mouse button is released
 *     &lt;li&gt;a mouse button is clicked (pressed and released)
 *     &lt;li&gt;the mouse cursor enters the unobscured part of component's geometry
 *     &lt;li&gt;the mouse cursor exits the unobscured part of component's geometry
 *     &lt;/ul&gt;
 * &lt;li&gt; Mouse Motion Events
 *     &lt;ul&gt;
 *     &lt;li&gt;the mouse is moved
 *     &lt;li&gt;the mouse is dragged
 *     &lt;/ul&gt;
 * &lt;/ul&gt;
 * &lt;P&gt;
 * A &lt;code&gt;MouseEvent&lt;/code&gt; object is passed to every
 * &lt;code&gt;MouseListener&lt;/code&gt;
 * or &lt;code&gt;MouseAdapter&lt;/code&gt; object which is registered to receive
 * the &quot;interesting&quot; mouse events using the component's
 * &lt;code&gt;addMouseListener&lt;/code&gt; method.
 * (&lt;code&gt;MouseAdapter&lt;/code&gt; objects implement the
 * &lt;code&gt;MouseListener&lt;/code&gt; interface.) Each such listener object
 * gets a &lt;code&gt;MouseEvent&lt;/code&gt; containing the mouse event.
 * &lt;P&gt;
 * A &lt;code&gt;MouseEvent&lt;/code&gt; object is also passed to every
 * &lt;code&gt;MouseMotionListener&lt;/code&gt; or
 * &lt;code&gt;MouseMotionAdapter&lt;/code&gt; object which is registered to receive
 * mouse motion events using the component's
 * &lt;code&gt;addMouseMotionListener&lt;/code&gt;
 * method. (&lt;code&gt;MouseMotionAdapter&lt;/code&gt; objects implement the
 * &lt;code&gt;MouseMotionListener&lt;/code&gt; interface.) Each such listener object
 * gets a &lt;code&gt;MouseEvent&lt;/code&gt; containing the mouse motion event.
 * &lt;P&gt;
 * When a mouse button is clicked, events are generated and sent to the
 * registered &lt;code&gt;MouseListener&lt;/code&gt;s.
 * The state of modal keys can be retrieved using {@link InputEvent#getModifiers}
 * and {@link InputEvent#getModifiersEx}.
 * The button mask returned by {@link InputEvent#getModifiers} reflects
 * only the button that changed state, not the current state of all buttons.
 * (Note: Due to overlap in the values of ALT_MASK/BUTTON2_MASK and
 * META_MASK/BUTTON3_MASK, this is not always true for mouse events involving
 * modifier keys).
 * To get the state of all buttons and modifier keys, use
 * {@link InputEvent#getModifiersEx}.
 * The button which has changed state is returned by {@link MouseEvent#getButton}
 * &lt;P&gt;
 * For example, if the first mouse button is pressed, events are sent in the
 * following order:
 * &lt;PRE&gt;
 *    &lt;b   &gt;id           &lt;/b   &gt;   &lt;b   &gt;modifiers   &lt;/b   &gt; &lt;b   &gt;button &lt;/b   &gt;
 *    &lt;code&gt;MOUSE_PRESSED&lt;/code&gt;:  &lt;code&gt;BUTTON1_MASK&lt;/code&gt; &lt;code&gt;BUTTON1&lt;/code&gt;
 *    &lt;code&gt;MOUSE_RELEASED&lt;/code&gt;: &lt;code&gt;BUTTON1_MASK&lt;/code&gt; &lt;code&gt;BUTTON1&lt;/code&gt;
 *    &lt;code&gt;MOUSE_CLICKED&lt;/code&gt;:  &lt;code&gt;BUTTON1_MASK&lt;/code&gt; &lt;code&gt;BUTTON1&lt;/code&gt;
 * &lt;/PRE&gt;
 * When multiple mouse buttons are pressed, each press, release, and click
 * results in a separate event.
 * &lt;P&gt;
 * For example, if the user presses &lt;b&gt;button 1&lt;/b&gt; followed by
 * &lt;b&gt;button 2&lt;/b&gt;, and then releases them in the same order,
 * the following sequence of events is generated:
 * &lt;PRE&gt;
 *    &lt;b   &gt;id           &lt;/b   &gt;   &lt;b   &gt;modifiers   &lt;/b   &gt; &lt;b   &gt;button &lt;/b   &gt;
 *    &lt;code&gt;MOUSE_PRESSED&lt;/code&gt;:  &lt;code&gt;BUTTON1_MASK&lt;/code&gt; &lt;code&gt;BUTTON1&lt;/code&gt;
 *    &lt;code&gt;MOUSE_PRESSED&lt;/code&gt;:  &lt;code&gt;BUTTON2_MASK&lt;/code&gt; &lt;code&gt;BUTTON2&lt;/code&gt;
 *    &lt;code&gt;MOUSE_RELEASED&lt;/code&gt;: &lt;code&gt;BUTTON1_MASK&lt;/code&gt; &lt;code&gt;BUTTON1&lt;/code&gt;
 *    &lt;code&gt;MOUSE_CLICKED&lt;/code&gt;:  &lt;code&gt;BUTTON1_MASK&lt;/code&gt; &lt;code&gt;BUTTON1&lt;/code&gt;
 *    &lt;code&gt;MOUSE_RELEASED&lt;/code&gt;: &lt;code&gt;BUTTON2_MASK&lt;/code&gt; &lt;code&gt;BUTTON2&lt;/code&gt;
 *    &lt;code&gt;MOUSE_CLICKED&lt;/code&gt;:  &lt;code&gt;BUTTON2_MASK&lt;/code&gt; &lt;code&gt;BUTTON2&lt;/code&gt;
 * &lt;/PRE&gt;
 * If &lt;b&gt;button 2&lt;/b&gt; is released first, the
 * &lt;code&gt;MOUSE_RELEASED&lt;/code&gt;/&lt;code&gt;MOUSE_CLICKED&lt;/code&gt; pair
 * for &lt;code&gt;BUTTON2_MASK&lt;/code&gt; arrives first,
 * followed by the pair for &lt;code&gt;BUTTON1_MASK&lt;/code&gt;.
 * &lt;p&gt;
 * Some extra mouse buttons are added to extend the standard set of buttons
 * represented by the following constants:{@code BUTTON1}, {@code BUTTON2}, and {@code BUTTON3}.
 * Extra buttons have no assigned {@code BUTTONx}
 * constants as well as their button masks have no assigned {@code BUTTONx_DOWN_MASK}
 * constants. Nevertheless, ordinal numbers starting from 4 may be
 * used as button numbers (button ids). Values obtained by the
 * {@link InputEvent#getMaskForButton(int) getMaskForButton(button)} method may be used
 * as button masks.
 * &lt;p&gt;
 * {@code MOUSE_DRAGGED} events are delivered to the {@code Component}
 * in which the mouse button was pressed until the mouse button is released
 * (regardless of whether the mouse position is within the bounds of the
 * {@code Component}).  Due to platform-dependent Drag&amp;amp;Drop implementations,
 * {@code MOUSE_DRAGGED} events may not be delivered during a native
 * Drag&amp;amp;Drop operation.
 *
 * In a multi-screen environment mouse drag events are delivered to the
 * &lt;code&gt;Component&lt;/code&gt; even if the mouse position is outside the bounds of the
 * &lt;code&gt;GraphicsConfiguration&lt;/code&gt; associated with that
 * &lt;code&gt;Component&lt;/code&gt;. However, the reported position for mouse drag events
 * in this case may differ from the actual mouse position:
 * &lt;ul&gt;
 * &lt;li&gt;In a multi-screen environment without a virtual device:
 * &lt;br&gt;
 * The reported coordinates for mouse drag events are clipped to fit within the
 * bounds of the &lt;code&gt;GraphicsConfiguration&lt;/code&gt; associated with
 * the &lt;code&gt;Component&lt;/code&gt;.
 * &lt;li&gt;In a multi-screen environment with a virtual device:
 * &lt;br&gt;
 * The reported coordinates for mouse drag events are clipped to fit within the
 * bounds of the virtual device associated with the &lt;code&gt;Component&lt;/code&gt;.
 * &lt;/ul&gt;
 * &lt;p&gt;
 * An unspecified behavior will be caused if the {@code id} parameter
 * of any particular {@code MouseEvent} instance is not
 * in the range from {@code MOUSE_FIRST} to {@code MOUSE_LAST}-1
 * ({@code MOUSE_WHEEL} is not acceptable).
 *
 * @author Carl Quinn
 *
 * @see MouseAdapter
 * @see MouseListener
 * @see MouseMotionAdapter
 * @see MouseMotionListener
 * @see MouseWheelListener
 * @see &lt;a href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html&quot;&gt;Tutorial: Writing a Mouse Listener&lt;/a&gt;
 * @see &lt;a href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/events/mousemotionlistener.html&quot;&gt;Tutorial: Writing a Mouse Motion Listener&lt;/a&gt;
 *
 * @since 1.1
 */
public class MouseEvent extends InputEvent {

    /**
     * The first number in the range of ids used for mouse events.
     */
    public static final int MOUSE_FIRST         = 500;

    /**
     * The last number in the range of ids used for mouse events.
     */
    public static final int MOUSE_LAST          = 507;

    /**
     * The &quot;mouse clicked&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when a mouse button is pressed and released.
     */
    public static final int MOUSE_CLICKED = MOUSE_FIRST;

    /**
     * The &quot;mouse pressed&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when a mouse button is pushed down.
     */
    public static final int MOUSE_PRESSED = 1 + MOUSE_FIRST; //Event.MOUSE_DOWN

    /**
     * The &quot;mouse released&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when a mouse button is let up.
     */
    public static final int MOUSE_RELEASED = 2 + MOUSE_FIRST; //Event.MOUSE_UP

    /**
     * The &quot;mouse moved&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when the mouse position changes.
     */
    public static final int MOUSE_MOVED = 3 + MOUSE_FIRST; //Event.MOUSE_MOVE

    /**
     * The &quot;mouse entered&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when the mouse cursor enters the unobscured part of component's
     * geometry.
     */
    public static final int MOUSE_ENTERED = 4 + MOUSE_FIRST; //Event.MOUSE_ENTER

    /**
     * The &quot;mouse exited&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when the mouse cursor exits the unobscured part of component's
     * geometry.
     */
    public static final int MOUSE_EXITED = 5 + MOUSE_FIRST; //Event.MOUSE_EXIT

    /**
     * The &quot;mouse dragged&quot; event. This &lt;code&gt;MouseEvent&lt;/code&gt;
     * occurs when the mouse position changes while a mouse button is pressed.
     */
    public static final int MOUSE_DRAGGED = 6 + MOUSE_FIRST; //Event.MOUSE_DRAG

    /**
     * The &quot;mouse wheel&quot; event.  This is the only &lt;code&gt;MouseWheelEvent&lt;/code&gt;.
     * It occurs when a mouse equipped with a wheel has its wheel rotated.
     * @since 1.4
     */
    public static final int MOUSE_WHEEL = 7 + MOUSE_FIRST;

    /**
     * Indicates no mouse buttons; used by {@link #getButton}.
     * @since 1.4
     */
    public static final int NOBUTTON = 0;

    /**
     * Indicates mouse button #1; used by {@link #getButton}.
     * @since 1.4
     */
    public static final int BUTTON1 = 1;

    /**
     * Indicates mouse button #2; used by {@link #getButton}.
     * @since 1.4
     */
    public static final int BUTTON2 = 2;

    /**
     * Indicates mouse button #3; used by {@link #getButton}.
     * @since 1.4
     */
    public static final int BUTTON3 = 3;

    /**
     * The mouse event's x coordinate.
     * The x value is relative to the component that fired the event.
     *
     * @serial
     * @see #getX()
     */
    int x;

    /**
     * The mouse event's y coordinate.
     * The y value is relative to the component that fired the event.
     *
     * @serial
     * @see #getY()
     */
    int y;

    /**
     * The mouse event's x absolute coordinate.
     * In a virtual device multi-screen environment in which the
     * desktop area could span multiple physical screen devices,
     * this coordinate is relative to the virtual coordinate system.
     * Otherwise, this coordinate is relative to the coordinate system
     * associated with the Component's GraphicsConfiguration.
     *
     * @serial
   */
    private int xAbs;

    /**
     * The mouse event's y absolute coordinate.
     * In a virtual device multi-screen environment in which the
     * desktop area could span multiple physical screen devices,
     * this coordinate is relative to the virtual coordinate system.
     * Otherwise, this coordinate is relative to the coordinate system
     * associated with the Component's GraphicsConfiguration.
     *
     * @serial
     */
    private int yAbs;

    /**
     * Indicates the number of quick consecutive clicks of
     * a mouse button.
     * clickCount will be valid for only three mouse events :&lt;BR&gt;
     * &lt;code&gt;MOUSE_CLICKED&lt;/code&gt;,
     * &lt;code&gt;MOUSE_PRESSED&lt;/code&gt; and
     * &lt;code&gt;MOUSE_RELEASED&lt;/code&gt;.
     * For the above, the &lt;code&gt;clickCount&lt;/code&gt; will be at least 1.
     * For all other events the count will be 0.
     *
     * @serial
     * @see #getClickCount()
     */
    int clickCount;

    /**
     * Indicates which, if any, of the mouse buttons has changed state.
     *
     * The valid values are ranged from 0 to the value returned by the
     * {@link java.awt.MouseInfo#getNumberOfButtons() MouseInfo.getNumberOfButtons()} method.
     * This range already includes constants {@code NOBUTTON}, {@code BUTTON1},
     * {@code BUTTON2}, and {@code BUTTON3}
     * if these buttons are present. So it is allowed to use these constants too.
     * For example, for a mouse with two buttons this field may contain the following values:
     * &lt;ul&gt;
     * &lt;li&gt; 0 ({@code NOBUTTON})
     * &lt;li&gt; 1 ({@code BUTTON1})
     * &lt;li&gt; 2 ({@code BUTTON2})
     * &lt;/ul&gt;
     * If a mouse has 5 buttons, this field may contain the following values:
     * &lt;ul&gt;
     * &lt;li&gt; 0 ({@code NOBUTTON})
     * &lt;li&gt; 1 ({@code BUTTON1})
     * &lt;li&gt; 2 ({@code BUTTON2})
     * &lt;li&gt; 3 ({@code BUTTON3})
     * &lt;li&gt; 4
     * &lt;li&gt; 5
     * &lt;/ul&gt;
     * If support for extended mouse buttons is {@link Toolkit#areExtraMouseButtonsEnabled()} disabled by Java
     * then the field may not contain the value larger than {@code BUTTON3}.
     * @serial
     * @see #getButton()
     * @see java.awt.Toolkit#areExtraMouseButtonsEnabled()
     */
    int button;

    /**
     * A property used to indicate whether a Popup Menu
     * should appear  with a certain gestures.
     * If &lt;code&gt;popupTrigger&lt;/code&gt; = &lt;code&gt;false&lt;/code&gt;,
     * no popup menu should appear.  If it is &lt;code&gt;true&lt;/code&gt;
     * then a popup menu should appear.
     *
     * @serial
     * @see java.awt.PopupMenu
     * @see #isPopupTrigger()
     */
<span class="nc" id="L376">    boolean popupTrigger = false;</span>

    /*
     * JDK 1.1 serialVersionUID
     */
    private static final long serialVersionUID = -991214153494842848L;

    /**
     * A number of buttons available on the mouse at the {@code Toolkit} machinery startup.
     */
    private static int cachedNumberOfButtons;

    static {
        /* ensure that the necessary native libraries are loaded */
<span class="nc" id="L390">        NativeLibLoader.loadLibraries();</span>
<span class="nc bnc" id="L391" title="All 2 branches missed.">        if (!GraphicsEnvironment.isHeadless()) {</span>
<span class="nc" id="L392">            initIDs();</span>
        }
<span class="nc" id="L394">        final Toolkit tk = Toolkit.getDefaultToolkit();</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">        if (tk instanceof SunToolkit) {</span>
<span class="nc" id="L396">            cachedNumberOfButtons = ((SunToolkit)tk).getNumberOfButtons();</span>
        } else {
            //It's expected that some toolkits (Headless,
            //whatever besides SunToolkit) could also operate.
<span class="nc" id="L400">            cachedNumberOfButtons = 3;</span>
        }
<span class="nc" id="L402">    }</span>

    /**
     * Initialize JNI field and method IDs for fields that may be
     *  accessed from C.
     */
    private static native void initIDs();

    /**
     * Returns the absolute x, y position of the event.
     * In a virtual device multi-screen environment in which the
     * desktop area could span multiple physical screen devices,
     * these coordinates are relative to the virtual coordinate system.
     * Otherwise, these coordinates are relative to the coordinate system
     * associated with the Component's GraphicsConfiguration.
     *
     * @return a &lt;code&gt;Point&lt;/code&gt; object containing the absolute  x
     *  and y coordinates.
     *
     * @see java.awt.GraphicsConfiguration
     * @since 1.6
     */
    public Point getLocationOnScreen(){
<span class="nc" id="L425">      return new Point(xAbs, yAbs);</span>
    }

    /**
     * Returns the absolute horizontal x position of the event.
     * In a virtual device multi-screen environment in which the
     * desktop area could span multiple physical screen devices,
     * this coordinate is relative to the virtual coordinate system.
     * Otherwise, this coordinate is relative to the coordinate system
     * associated with the Component's GraphicsConfiguration.
     *
     * @return x  an integer indicating absolute horizontal position.
     *
     * @see java.awt.GraphicsConfiguration
     * @since 1.6
     */
    public int getXOnScreen() {
<span class="nc" id="L442">        return xAbs;</span>
    }

    /**
     * Returns the absolute vertical y position of the event.
     * In a virtual device multi-screen environment in which the
     * desktop area could span multiple physical screen devices,
     * this coordinate is relative to the virtual coordinate system.
     * Otherwise, this coordinate is relative to the coordinate system
     * associated with the Component's GraphicsConfiguration.
     *
     * @return y  an integer indicating absolute vertical position.
     *
     * @see java.awt.GraphicsConfiguration
     * @since 1.6
     */
    public int getYOnScreen() {
<span class="nc" id="L459">        return yAbs;</span>
    }

    /**
     * Constructs a &lt;code&gt;MouseEvent&lt;/code&gt; object with the
     * specified source component,
     * type, time, modifiers, coordinates, click count, popupTrigger flag,
     * and button number.
     * &lt;p&gt;
     * Creating an invalid event (such
     * as by using more than one of the old _MASKs, or modifier/button
     * values which don't match) results in unspecified behavior.
     * An invocation of the form
     * &lt;tt&gt;MouseEvent(source, id, when, modifiers, x, y, clickCount, popupTrigger, button)&lt;/tt&gt;
     * behaves in exactly the same way as the invocation
     * &lt;tt&gt; {@link #MouseEvent(Component, int, long, int, int, int,
     * int, int, int, boolean, int) MouseEvent}(source, id, when, modifiers,
     * x, y, xAbs, yAbs, clickCount, popupTrigger, button)&lt;/tt&gt;
     * where xAbs and yAbs defines as source's location on screen plus
     * relative coordinates x and y.
     * xAbs and yAbs are set to zero if the source is not showing.
     * This method throws an
     * &lt;code&gt;IllegalArgumentException&lt;/code&gt; if &lt;code&gt;source&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt;.
     *
     * @param source       The &lt;code&gt;Component&lt;/code&gt; that originated the event
     * @param id              An integer indicating the type of event.
     *                     For information on allowable values, see
     *                     the class description for {@link MouseEvent}
     * @param when         A long integer that gives the time the event occurred.
     *                     Passing negative or zero value
     *                     is not recommended
     * @param modifiers    a modifier mask describing the modifier keys and mouse
     *                     buttons (for example, shift, ctrl, alt, and meta) that
     *                     are down during the event.
     *                     Only extended modifiers are allowed to be used as a
     *                     value for this parameter (see the {@link InputEvent#getModifiersEx}
     *                     class for the description of extended modifiers).
     *                     Passing negative parameter
     *                     is not recommended.
     *                     Zero value means that no modifiers were passed
     * @param x            The horizontal x coordinate for the mouse location.
     *                       It is allowed to pass negative values
     * @param y            The vertical y coordinate for the mouse location.
     *                       It is allowed to pass negative values
     * @param clickCount   The number of mouse clicks associated with event.
     *                       Passing negative value
     *                       is not recommended
     * @param popupTrigger A boolean that equals {@code true} if this event
     *                     is a trigger for a popup menu
     * @param button       An integer that indicates, which of the mouse buttons has
     *                     changed its state.
     * The following rules are applied to this parameter:
     * &lt;ul&gt;
     * &lt;li&gt;If support for the extended mouse buttons is
     * {@link Toolkit#areExtraMouseButtonsEnabled() disabled} by Java
     * then it is allowed to create {@code MouseEvent} objects only with the standard buttons:
     * {@code NOBUTTON}, {@code BUTTON1}, {@code BUTTON2}, and
     * {@code BUTTON3}.
     * &lt;li&gt; If support for the extended mouse buttons is
     * {@link Toolkit#areExtraMouseButtonsEnabled() enabled} by Java
     * then it is allowed to create {@code MouseEvent} objects with
     * the standard buttons.
     * In case the support for extended mouse buttons is
     * {@link Toolkit#areExtraMouseButtonsEnabled() enabled} by Java, then
     * in addition to the standard buttons, {@code MouseEvent} objects can be created
     * using buttons from the range starting from 4 to
     * {@link java.awt.MouseInfo#getNumberOfButtons() MouseInfo.getNumberOfButtons()}
     * if the mouse has more than three buttons.
     * &lt;/ul&gt;
     * @throws IllegalArgumentException if {@code button} is less then zero
     * @throws IllegalArgumentException if &lt;code&gt;source&lt;/code&gt; is null
     * @throws IllegalArgumentException if {@code button} is greater then BUTTON3 and the support for extended mouse buttons is
     *                                  {@link Toolkit#areExtraMouseButtonsEnabled() disabled} by Java
     * @throws IllegalArgumentException if {@code button} is greater then the
     *                                  {@link java.awt.MouseInfo#getNumberOfButtons() current number of buttons} and the support
     *                                  for extended mouse buttons is {@link Toolkit#areExtraMouseButtonsEnabled() enabled}
     *                                  by Java
     * @throws IllegalArgumentException if an invalid &lt;code&gt;button&lt;/code&gt;
     *            value is passed in
     * @throws IllegalArgumentException if &lt;code&gt;source&lt;/code&gt; is null
     * @see #getSource()
     * @see #getID()
     * @see #getWhen()
     * @see #getModifiers()
     * @see #getX()
     * @see #getY()
     * @see #getClickCount()
     * @see #isPopupTrigger()
     * @see #getButton()
     * @since 1.4
     */
    public MouseEvent(Component source, int id, long when, int modifiers,
                      int x, int y, int clickCount, boolean popupTrigger,
                      int button)
    {
<span class="nc" id="L555">        this(source, id, when, modifiers, x, y, 0, 0, clickCount, popupTrigger, button);</span>
<span class="nc" id="L556">        Point eventLocationOnScreen = new Point(0, 0);</span>
        try {
<span class="nc" id="L558">          eventLocationOnScreen = source.getLocationOnScreen();</span>
<span class="nc" id="L559">          this.xAbs = eventLocationOnScreen.x + x;</span>
<span class="nc" id="L560">          this.yAbs = eventLocationOnScreen.y + y;</span>
<span class="nc" id="L561">        } catch (IllegalComponentStateException e){</span>
<span class="nc" id="L562">          this.xAbs = 0;</span>
<span class="nc" id="L563">          this.yAbs = 0;</span>
<span class="nc" id="L564">        }</span>
<span class="nc" id="L565">    }</span>

    /**
     * Constructs a &lt;code&gt;MouseEvent&lt;/code&gt; object with the
     * specified source component,
     * type, modifiers, coordinates, click count, and popupTrigger flag.
     * An invocation of the form
     * &lt;tt&gt;MouseEvent(source, id, when, modifiers, x, y, clickCount, popupTrigger)&lt;/tt&gt;
     * behaves in exactly the same way as the invocation
     * &lt;tt&gt; {@link #MouseEvent(Component, int, long, int, int, int,
     * int, int, int, boolean, int) MouseEvent}(source, id, when, modifiers,
     * x, y, xAbs, yAbs, clickCount, popupTrigger, MouseEvent.NOBUTTON)&lt;/tt&gt;
     * where xAbs and yAbs defines as source's location on screen plus
     * relative coordinates x and y.
     * xAbs and yAbs are set to zero if the source is not showing.
     * This method throws an &lt;code&gt;IllegalArgumentException&lt;/code&gt;
     * if &lt;code&gt;source&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;.
     *
     * @param source       The &lt;code&gt;Component&lt;/code&gt; that originated the event
     * @param id              An integer indicating the type of event.
     *                     For information on allowable values, see
     *                     the class description for {@link MouseEvent}
     * @param when         A long integer that gives the time the event occurred.
     *                     Passing negative or zero value
     *                     is not recommended
     * @param modifiers    a modifier mask describing the modifier keys and mouse
     *                     buttons (for example, shift, ctrl, alt, and meta) that
     *                     are down during the event.
     *                     Only extended modifiers are allowed to be used as a
     *                     value for this parameter (see the {@link InputEvent#getModifiersEx}
     *                     class for the description of extended modifiers).
     *                     Passing negative parameter
     *                     is not recommended.
     *                     Zero value means that no modifiers were passed
     * @param x            The horizontal x coordinate for the mouse location.
     *                       It is allowed to pass negative values
     * @param y            The vertical y coordinate for the mouse location.
     *                       It is allowed to pass negative values
     * @param clickCount   The number of mouse clicks associated with event.
     *                       Passing negative value
     *                       is not recommended
     * @param popupTrigger A boolean that equals {@code true} if this event
     *                     is a trigger for a popup menu
     * @throws IllegalArgumentException if &lt;code&gt;source&lt;/code&gt; is null
     * @see #getSource()
     * @see #getID()
     * @see #getWhen()
     * @see #getModifiers()
     * @see #getX()
     * @see #getY()
     * @see #getClickCount()
     * @see #isPopupTrigger()
     */
     public MouseEvent(Component source, int id, long when, int modifiers,
                      int x, int y, int clickCount, boolean popupTrigger) {
<span class="nc" id="L620">        this(source, id, when, modifiers, x, y, clickCount, popupTrigger, NOBUTTON);</span>
<span class="nc" id="L621">     }</span>


    /* if the button is an extra button and it is released or clicked then in Xsystem its state
       is not modified. Exclude this button number from ExtModifiers mask.*/
<span class="nc" id="L626">    transient private boolean shouldExcludeButtonFromExtModifiers = false;</span>

    /**
     * {@inheritDoc}
     */
    public int getModifiersEx() {
<span class="nc" id="L632">        int tmpModifiers = modifiers;</span>
<span class="nc bnc" id="L633" title="All 2 branches missed.">        if (shouldExcludeButtonFromExtModifiers) {</span>
<span class="nc" id="L634">            tmpModifiers &amp;= ~(InputEvent.getMaskForButton(getButton()));</span>
        }
<span class="nc" id="L636">        return tmpModifiers &amp; ~JDK_1_3_MODIFIERS;</span>
    }

    /**
     * Constructs a &lt;code&gt;MouseEvent&lt;/code&gt; object with the
     * specified source component,
     * type, time, modifiers, coordinates, absolute coordinates, click count, popupTrigger flag,
     * and button number.
     * &lt;p&gt;
     * Creating an invalid event (such
     * as by using more than one of the old _MASKs, or modifier/button
     * values which don't match) results in unspecified behavior.
     * Even if inconsistent values for relative and absolute coordinates are
     * passed to the constructor, the mouse event instance is still
     * created and no exception is thrown.
     * This method throws an
     * &lt;code&gt;IllegalArgumentException&lt;/code&gt; if &lt;code&gt;source&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt;.
     *
     * @param source       The &lt;code&gt;Component&lt;/code&gt; that originated the event
     * @param id              An integer indicating the type of event.
     *                     For information on allowable values, see
     *                     the class description for {@link MouseEvent}
     * @param when         A long integer that gives the time the event occurred.
     *                     Passing negative or zero value
     *                     is not recommended
     * @param modifiers    a modifier mask describing the modifier keys and mouse
     *                     buttons (for example, shift, ctrl, alt, and meta) that
     *                     are down during the event.
     *                     Only extended modifiers are allowed to be used as a
     *                     value for this parameter (see the {@link InputEvent#getModifiersEx}
     *                     class for the description of extended modifiers).
     *                     Passing negative parameter
     *                     is not recommended.
     *                     Zero value means that no modifiers were passed
     * @param x            The horizontal x coordinate for the mouse location.
     *                       It is allowed to pass negative values
     * @param y            The vertical y coordinate for the mouse location.
     *                       It is allowed to pass negative values
     * @param xAbs           The absolute horizontal x coordinate for the mouse location
     *                       It is allowed to pass negative values
     * @param yAbs           The absolute vertical y coordinate for the mouse location
     *                       It is allowed to pass negative values
     * @param clickCount   The number of mouse clicks associated with event.
     *                       Passing negative value
     *                       is not recommended
     * @param popupTrigger A boolean that equals {@code true} if this event
     *                     is a trigger for a popup menu
     * @param button       An integer that indicates, which of the mouse buttons has
     *                     changed its state.
     * The following rules are applied to this parameter:
     * &lt;ul&gt;
     * &lt;li&gt;If support for the extended mouse buttons is
     * {@link Toolkit#areExtraMouseButtonsEnabled() disabled} by Java
     * then it is allowed to create {@code MouseEvent} objects only with the standard buttons:
     * {@code NOBUTTON}, {@code BUTTON1}, {@code BUTTON2}, and
     * {@code BUTTON3}.
     * &lt;li&gt; If support for the extended mouse buttons is
     * {@link Toolkit#areExtraMouseButtonsEnabled() enabled} by Java
     * then it is allowed to create {@code MouseEvent} objects with
     * the standard buttons.
     * In case the support for extended mouse buttons is
     * {@link Toolkit#areExtraMouseButtonsEnabled() enabled} by Java, then
     * in addition to the standard buttons, {@code MouseEvent} objects can be created
     * using buttons from the range starting from 4 to
     * {@link java.awt.MouseInfo#getNumberOfButtons() MouseInfo.getNumberOfButtons()}
     * if the mouse has more than three buttons.
     * &lt;/ul&gt;
     * @throws IllegalArgumentException if {@code button} is less then zero
     * @throws IllegalArgumentException if &lt;code&gt;source&lt;/code&gt; is null
     * @throws IllegalArgumentException if {@code button} is greater then BUTTON3 and the support for extended mouse buttons is
     *                                  {@link Toolkit#areExtraMouseButtonsEnabled() disabled} by Java
     * @throws IllegalArgumentException if {@code button} is greater then the
     *                                  {@link java.awt.MouseInfo#getNumberOfButtons() current number of buttons} and the support
     *                                  for extended mouse buttons is {@link Toolkit#areExtraMouseButtonsEnabled() enabled}
     *                                  by Java
     * @throws IllegalArgumentException if an invalid &lt;code&gt;button&lt;/code&gt;
     *            value is passed in
     * @throws IllegalArgumentException if &lt;code&gt;source&lt;/code&gt; is null
     * @see #getSource()
     * @see #getID()
     * @see #getWhen()
     * @see #getModifiers()
     * @see #getX()
     * @see #getY()
     * @see #getXOnScreen()
     * @see #getYOnScreen()
     * @see #getClickCount()
     * @see #isPopupTrigger()
     * @see #getButton()
     * @see #button
     * @see Toolkit#areExtraMouseButtonsEnabled()
     * @see java.awt.MouseInfo#getNumberOfButtons()
     * @see InputEvent#getMaskForButton(int)
     * @since 1.6
     */
    public MouseEvent(Component source, int id, long when, int modifiers,
                      int x, int y, int xAbs, int yAbs,
                      int clickCount, boolean popupTrigger, int button)
    {
<span class="nc" id="L736">        super(source, id, when, modifiers);</span>
<span class="nc" id="L737">        this.x = x;</span>
<span class="nc" id="L738">        this.y = y;</span>
<span class="nc" id="L739">        this.xAbs = xAbs;</span>
<span class="nc" id="L740">        this.yAbs = yAbs;</span>
<span class="nc" id="L741">        this.clickCount = clickCount;</span>
<span class="nc" id="L742">        this.popupTrigger = popupTrigger;</span>
<span class="nc bnc" id="L743" title="All 2 branches missed.">        if (button &lt; NOBUTTON){</span>
<span class="nc" id="L744">            throw new IllegalArgumentException(&quot;Invalid button value :&quot; + button);</span>
        }
<span class="nc bnc" id="L746" title="All 2 branches missed.">        if (button &gt; BUTTON3) {</span>
<span class="nc bnc" id="L747" title="All 2 branches missed.">            if (!Toolkit.getDefaultToolkit().areExtraMouseButtonsEnabled()){</span>
<span class="nc" id="L748">                throw new IllegalArgumentException(&quot;Extra mouse events are disabled &quot; + button);</span>
            } else {
<span class="nc bnc" id="L750" title="All 2 branches missed.">                if (button &gt; cachedNumberOfButtons) {</span>
<span class="nc" id="L751">                    throw new IllegalArgumentException(&quot;Nonexistent button &quot; + button);</span>
                }
            }
            // XToolkit: extra buttons are not reporting about their state correctly.
            // Being pressed they report the state=0 both on the press and on the release.
            // For 1-3 buttons the state value equals zero on press and non-zero on release.
            // Other modifiers like Shift, ALT etc seem report well with extra buttons.
            // The problem reveals as follows: one button is pressed and then another button is pressed and released.
            // So, the getModifiersEx() would not be zero due to a first button and we will skip this modifier.
            // This may have to be moved into the peer code instead if possible.

<span class="nc bnc" id="L762" title="All 2 branches missed.">            if (getModifiersEx() != 0) { //There is at least one more button in a pressed state.</span>
<span class="nc bnc" id="L763" title="All 4 branches missed.">                if (id == MouseEvent.MOUSE_RELEASED || id == MouseEvent.MOUSE_CLICKED){</span>
<span class="nc" id="L764">                    shouldExcludeButtonFromExtModifiers = true;</span>
                }
            }
        }

<span class="nc" id="L769">        this.button = button;</span>

<span class="nc bnc" id="L771" title="All 4 branches missed.">        if ((getModifiers() != 0) &amp;&amp; (getModifiersEx() == 0)) {</span>
<span class="nc" id="L772">            setNewModifiers();</span>
<span class="nc bnc" id="L773" title="All 2 branches missed.">        } else if ((getModifiers() == 0) &amp;&amp;</span>
<span class="nc bnc" id="L774" title="All 6 branches missed.">                   (getModifiersEx() != 0 || button != NOBUTTON) &amp;&amp;</span>
                   (button &lt;= BUTTON3))
        {
<span class="nc" id="L777">            setOldModifiers();</span>
        }
<span class="nc" id="L779">    }</span>

    /**
     * Returns the horizontal x position of the event relative to the
     * source component.
     *
     * @return x  an integer indicating horizontal position relative to
     *            the component
     */
    public int getX() {
<span class="nc" id="L789">        return x;</span>
    }

    /**
     * Returns the vertical y position of the event relative to the
     * source component.
     *
     * @return y  an integer indicating vertical position relative to
     *            the component
     */
    public int getY() {
<span class="nc" id="L800">        return y;</span>
    }

    /**
     * Returns the x,y position of the event relative to the source component.
     *
     * @return a &lt;code&gt;Point&lt;/code&gt; object containing the x and y coordinates
     *         relative to the source component
     *
     */
    public Point getPoint() {
        int x;
        int y;
<span class="nc" id="L813">        synchronized (this) {</span>
<span class="nc" id="L814">            x = this.x;</span>
<span class="nc" id="L815">            y = this.y;</span>
<span class="nc" id="L816">        }</span>
<span class="nc" id="L817">        return new Point(x, y);</span>
    }

    /**
     * Translates the event's coordinates to a new position
     * by adding specified &lt;code&gt;x&lt;/code&gt; (horizontal) and &lt;code&gt;y&lt;/code&gt;
     * (vertical) offsets.
     *
     * @param x the horizontal x value to add to the current x
     *          coordinate position
     * @param y the vertical y value to add to the current y
                coordinate position
     */
    public synchronized void translatePoint(int x, int y) {
<span class="nc" id="L831">        this.x += x;</span>
<span class="nc" id="L832">        this.y += y;</span>
<span class="nc" id="L833">    }</span>

    /**
     * Returns the number of mouse clicks associated with this event.
     *
     * @return integer value for the number of clicks
     */
    public int getClickCount() {
<span class="nc" id="L841">        return clickCount;</span>
    }

    /**
     * Returns which, if any, of the mouse buttons has changed state.
     * The returned value is ranged
     * from 0 to the {@link java.awt.MouseInfo#getNumberOfButtons() MouseInfo.getNumberOfButtons()}
     * value.
     * The returned value includes at least the following constants:
     * &lt;ul&gt;
     * &lt;li&gt; {@code NOBUTTON}
     * &lt;li&gt; {@code BUTTON1}
     * &lt;li&gt; {@code BUTTON2}
     * &lt;li&gt; {@code BUTTON3}
     * &lt;/ul&gt;
     * It is allowed to use those constants to compare with the returned button number in the application.
     * For example,
     * &lt;pre&gt;
     * if (anEvent.getButton() == MouseEvent.BUTTON1) {
     * &lt;/pre&gt;
     * In particular, for a mouse with one, two, or three buttons this method may return the following values:
     * &lt;ul&gt;
     * &lt;li&gt; 0 ({@code NOBUTTON})
     * &lt;li&gt; 1 ({@code BUTTON1})
     * &lt;li&gt; 2 ({@code BUTTON2})
     * &lt;li&gt; 3 ({@code BUTTON3})
     * &lt;/ul&gt;
     * Button numbers greater then {@code BUTTON3} have no constant identifier. So if a mouse with five buttons is
     * installed, this method may return the following values:
     * &lt;ul&gt;
     * &lt;li&gt; 0 ({@code NOBUTTON})
     * &lt;li&gt; 1 ({@code BUTTON1})
     * &lt;li&gt; 2 ({@code BUTTON2})
     * &lt;li&gt; 3 ({@code BUTTON3})
     * &lt;li&gt; 4
     * &lt;li&gt; 5
     * &lt;/ul&gt;
     * &lt;p&gt;
     * Note: If support for extended mouse buttons is {@link Toolkit#areExtraMouseButtonsEnabled() disabled} by Java
     * then the AWT event subsystem does not produce mouse events for the extended mouse
     * buttons. So it is not expected that this method returns anything except {@code NOBUTTON}, {@code BUTTON1},
     * {@code BUTTON2}, {@code BUTTON3}.
     *
     * @return one of the values from 0 to {@link java.awt.MouseInfo#getNumberOfButtons() MouseInfo.getNumberOfButtons()}
     *         if support for the extended mouse buttons is {@link Toolkit#areExtraMouseButtonsEnabled() enabled} by Java.
     *         That range includes {@code NOBUTTON}, {@code BUTTON1}, {@code BUTTON2}, {@code BUTTON3};
     *         &lt;br&gt;
     *         {@code NOBUTTON}, {@code BUTTON1}, {@code BUTTON2} or {@code BUTTON3}
     *         if support for the extended mouse buttons is {@link Toolkit#areExtraMouseButtonsEnabled() disabled} by Java
     * @since 1.4
     * @see Toolkit#areExtraMouseButtonsEnabled()
     * @see java.awt.MouseInfo#getNumberOfButtons()
     * @see #MouseEvent(Component, int, long, int, int, int, int, int, int, boolean, int)
     * @see InputEvent#getMaskForButton(int)
     */
    public int getButton() {
<span class="nc" id="L897">        return button;</span>
    }

    /**
     * Returns whether or not this mouse event is the popup menu
     * trigger event for the platform.
     * &lt;p&gt;&lt;b&gt;Note&lt;/b&gt;: Popup menus are triggered differently
     * on different systems. Therefore, &lt;code&gt;isPopupTrigger&lt;/code&gt;
     * should be checked in both &lt;code&gt;mousePressed&lt;/code&gt;
     * and &lt;code&gt;mouseReleased&lt;/code&gt;
     * for proper cross-platform functionality.
     *
     * @return boolean, true if this event is the popup menu trigger
     *         for this platform
     */
    public boolean isPopupTrigger() {
<span class="nc" id="L913">        return popupTrigger;</span>
    }

    /**
     * Returns a &lt;code&gt;String&lt;/code&gt; instance describing the modifier keys and
     * mouse buttons that were down during the event, such as &quot;Shift&quot;,
     * or &quot;Ctrl+Shift&quot;. These strings can be localized by changing
     * the &lt;code&gt;awt.properties&lt;/code&gt; file.
     * &lt;p&gt;
     * Note that the &lt;code&gt;InputEvent.ALT_MASK&lt;/code&gt; and
     * &lt;code&gt;InputEvent.BUTTON2_MASK&lt;/code&gt; have equal values,
     * so the &quot;Alt&quot; string is returned for both modifiers.  Likewise,
     * the &lt;code&gt;InputEvent.META_MASK&lt;/code&gt; and
     * &lt;code&gt;InputEvent.BUTTON3_MASK&lt;/code&gt; have equal values,
     * so the &quot;Meta&quot; string is returned for both modifiers.
     * &lt;p&gt;
     * Note that passing negative parameter is incorrect,
     * and will cause the returning an unspecified string.
     * Zero parameter means that no modifiers were passed and will
     * cause the returning an empty string.
     * &lt;p&gt;
     * @param modifiers A modifier mask describing the modifier keys and
     *                  mouse buttons that were down during the event
     * @return string   string text description of the combination of modifier
     *                  keys and mouse buttons that were down during the event
     * @see InputEvent#getModifiersExText(int)
     * @since 1.4
     */
    public static String getMouseModifiersText(int modifiers) {
<span class="nc" id="L942">        StringBuilder buf = new StringBuilder();</span>
<span class="nc bnc" id="L943" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_MASK) != 0) {</span>
<span class="nc" id="L944">            buf.append(Toolkit.getProperty(&quot;AWT.alt&quot;, &quot;Alt&quot;));</span>
<span class="nc" id="L945">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L947" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.META_MASK) != 0) {</span>
<span class="nc" id="L948">            buf.append(Toolkit.getProperty(&quot;AWT.meta&quot;, &quot;Meta&quot;));</span>
<span class="nc" id="L949">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L951" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.CTRL_MASK) != 0) {</span>
<span class="nc" id="L952">            buf.append(Toolkit.getProperty(&quot;AWT.control&quot;, &quot;Ctrl&quot;));</span>
<span class="nc" id="L953">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L955" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.SHIFT_MASK) != 0) {</span>
<span class="nc" id="L956">            buf.append(Toolkit.getProperty(&quot;AWT.shift&quot;, &quot;Shift&quot;));</span>
<span class="nc" id="L957">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L959" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_GRAPH_MASK) != 0) {</span>
<span class="nc" id="L960">            buf.append(Toolkit.getProperty(&quot;AWT.altGraph&quot;, &quot;Alt Graph&quot;));</span>
<span class="nc" id="L961">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L963" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.BUTTON1_MASK) != 0) {</span>
<span class="nc" id="L964">            buf.append(Toolkit.getProperty(&quot;AWT.button1&quot;, &quot;Button1&quot;));</span>
<span class="nc" id="L965">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L967" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.BUTTON2_MASK) != 0) {</span>
<span class="nc" id="L968">            buf.append(Toolkit.getProperty(&quot;AWT.button2&quot;, &quot;Button2&quot;));</span>
<span class="nc" id="L969">            buf.append(&quot;+&quot;);</span>
        }
<span class="nc bnc" id="L971" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.BUTTON3_MASK) != 0) {</span>
<span class="nc" id="L972">            buf.append(Toolkit.getProperty(&quot;AWT.button3&quot;, &quot;Button3&quot;));</span>
<span class="nc" id="L973">            buf.append(&quot;+&quot;);</span>
        }

        int mask;

        // TODO: add a toolkit field that holds a number of button on the mouse.
        // As the method getMouseModifiersText() is static and obtain
        // an integer as a parameter then we may not restrict this with the number
        // of buttons installed on the mouse.
        // It's a temporary solution. We need to somehow hold the number of buttons somewhere else.
<span class="nc bnc" id="L983" title="All 2 branches missed.">        for (int i = 1; i &lt;= cachedNumberOfButtons; i++){</span>
<span class="nc" id="L984">            mask = InputEvent.getMaskForButton(i);</span>
<span class="nc bnc" id="L985" title="All 2 branches missed.">            if ((modifiers &amp; mask) != 0 &amp;&amp;</span>
<span class="nc bnc" id="L986" title="All 2 branches missed.">                buf.indexOf(Toolkit.getProperty(&quot;AWT.button&quot;+i, &quot;Button&quot;+i)) == -1) //1,2,3 buttons may already be there; so don't duplicate it.</span>
            {
<span class="nc" id="L988">                buf.append(Toolkit.getProperty(&quot;AWT.button&quot;+i, &quot;Button&quot;+i));</span>
<span class="nc" id="L989">                buf.append(&quot;+&quot;);</span>
            }
        }

<span class="nc bnc" id="L993" title="All 2 branches missed.">        if (buf.length() &gt; 0) {</span>
<span class="nc" id="L994">            buf.setLength(buf.length()-1); // remove trailing '+'</span>
        }
<span class="nc" id="L996">        return buf.toString();</span>
    }

    /**
     * Returns a parameter string identifying this event.
     * This method is useful for event-logging and for debugging.
     *
     * @return a string identifying the event and its attributes
     */
    public String paramString() {
<span class="nc" id="L1006">        StringBuilder str = new StringBuilder(80);</span>

<span class="nc bnc" id="L1008" title="All 9 branches missed.">        switch(id) {</span>
          case MOUSE_PRESSED:
<span class="nc" id="L1010">              str.append(&quot;MOUSE_PRESSED&quot;);</span>
<span class="nc" id="L1011">              break;</span>
          case MOUSE_RELEASED:
<span class="nc" id="L1013">              str.append(&quot;MOUSE_RELEASED&quot;);</span>
<span class="nc" id="L1014">              break;</span>
          case MOUSE_CLICKED:
<span class="nc" id="L1016">              str.append(&quot;MOUSE_CLICKED&quot;);</span>
<span class="nc" id="L1017">              break;</span>
          case MOUSE_ENTERED:
<span class="nc" id="L1019">              str.append(&quot;MOUSE_ENTERED&quot;);</span>
<span class="nc" id="L1020">              break;</span>
          case MOUSE_EXITED:
<span class="nc" id="L1022">              str.append(&quot;MOUSE_EXITED&quot;);</span>
<span class="nc" id="L1023">              break;</span>
          case MOUSE_MOVED:
<span class="nc" id="L1025">              str.append(&quot;MOUSE_MOVED&quot;);</span>
<span class="nc" id="L1026">              break;</span>
          case MOUSE_DRAGGED:
<span class="nc" id="L1028">              str.append(&quot;MOUSE_DRAGGED&quot;);</span>
<span class="nc" id="L1029">              break;</span>
          case MOUSE_WHEEL:
<span class="nc" id="L1031">              str.append(&quot;MOUSE_WHEEL&quot;);</span>
<span class="nc" id="L1032">              break;</span>
           default:
<span class="nc" id="L1034">              str.append(&quot;unknown type&quot;);</span>
        }

        // (x,y) coordinates
<span class="nc" id="L1038">        str.append(&quot;,(&quot;).append(x).append(&quot;,&quot;).append(y).append(&quot;)&quot;);</span>
<span class="nc" id="L1039">        str.append(&quot;,absolute(&quot;).append(xAbs).append(&quot;,&quot;).append(yAbs).append(&quot;)&quot;);</span>

<span class="nc bnc" id="L1041" title="All 4 branches missed.">        if (id != MOUSE_DRAGGED &amp;&amp; id != MOUSE_MOVED){</span>
<span class="nc" id="L1042">            str.append(&quot;,button=&quot;).append(getButton());</span>
        }

<span class="nc bnc" id="L1045" title="All 2 branches missed.">        if (getModifiers() != 0) {</span>
<span class="nc" id="L1046">            str.append(&quot;,modifiers=&quot;).append(getMouseModifiersText(modifiers));</span>
        }

<span class="nc bnc" id="L1049" title="All 2 branches missed.">        if (getModifiersEx() != 0) {</span>
            //Using plain &quot;modifiers&quot; here does show an excluded extended buttons in the string event representation.
            //getModifiersEx() solves the problem.
<span class="nc" id="L1052">            str.append(&quot;,extModifiers=&quot;).append(getModifiersExText(getModifiersEx()));</span>
        }

<span class="nc" id="L1055">        str.append(&quot;,clickCount=&quot;).append(clickCount);</span>

<span class="nc" id="L1057">        return str.toString();</span>
    }

    /**
     * Sets new modifiers by the old ones.
     * Also sets button.
     */
    private void setNewModifiers() {
<span class="nc bnc" id="L1065" title="All 2 branches missed.">        if ((modifiers &amp; BUTTON1_MASK) != 0) {</span>
<span class="nc" id="L1066">            modifiers |= BUTTON1_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1068" title="All 2 branches missed.">        if ((modifiers &amp; BUTTON2_MASK) != 0) {</span>
<span class="nc" id="L1069">            modifiers |= BUTTON2_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1071" title="All 2 branches missed.">        if ((modifiers &amp; BUTTON3_MASK) != 0) {</span>
<span class="nc" id="L1072">            modifiers |= BUTTON3_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1074" title="All 6 branches missed.">        if (id == MOUSE_PRESSED</span>
            || id == MOUSE_RELEASED
            || id == MOUSE_CLICKED)
        {
<span class="nc bnc" id="L1078" title="All 2 branches missed.">            if ((modifiers &amp; BUTTON1_MASK) != 0) {</span>
<span class="nc" id="L1079">                button = BUTTON1;</span>
<span class="nc" id="L1080">                modifiers &amp;= ~BUTTON2_MASK &amp; ~BUTTON3_MASK;</span>
<span class="nc bnc" id="L1081" title="All 2 branches missed.">                if (id != MOUSE_PRESSED) {</span>
<span class="nc" id="L1082">                    modifiers &amp;= ~BUTTON1_DOWN_MASK;</span>
                }
<span class="nc bnc" id="L1084" title="All 2 branches missed.">            } else if ((modifiers &amp; BUTTON2_MASK) != 0) {</span>
<span class="nc" id="L1085">                button = BUTTON2;</span>
<span class="nc" id="L1086">                modifiers &amp;= ~BUTTON1_MASK &amp; ~BUTTON3_MASK;</span>
<span class="nc bnc" id="L1087" title="All 2 branches missed.">                if (id != MOUSE_PRESSED) {</span>
<span class="nc" id="L1088">                    modifiers &amp;= ~BUTTON2_DOWN_MASK;</span>
                }
<span class="nc bnc" id="L1090" title="All 2 branches missed.">            } else if ((modifiers &amp; BUTTON3_MASK) != 0) {</span>
<span class="nc" id="L1091">                button = BUTTON3;</span>
<span class="nc" id="L1092">                modifiers &amp;= ~BUTTON1_MASK &amp; ~BUTTON2_MASK;</span>
<span class="nc bnc" id="L1093" title="All 2 branches missed.">                if (id != MOUSE_PRESSED) {</span>
<span class="nc" id="L1094">                    modifiers &amp;= ~BUTTON3_DOWN_MASK;</span>
                }
            }
        }
<span class="nc bnc" id="L1098" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_MASK) != 0) {</span>
<span class="nc" id="L1099">            modifiers |= InputEvent.ALT_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1101" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.META_MASK) != 0) {</span>
<span class="nc" id="L1102">            modifiers |= InputEvent.META_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1104" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.SHIFT_MASK) != 0) {</span>
<span class="nc" id="L1105">            modifiers |= InputEvent.SHIFT_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1107" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.CTRL_MASK) != 0) {</span>
<span class="nc" id="L1108">            modifiers |= InputEvent.CTRL_DOWN_MASK;</span>
        }
<span class="nc bnc" id="L1110" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_GRAPH_MASK) != 0) {</span>
<span class="nc" id="L1111">            modifiers |= InputEvent.ALT_GRAPH_DOWN_MASK;</span>
        }
<span class="nc" id="L1113">    }</span>

    /**
     * Sets old modifiers by the new ones.
     */
    private void setOldModifiers() {
<span class="nc bnc" id="L1119" title="All 6 branches missed.">        if (id == MOUSE_PRESSED</span>
            || id == MOUSE_RELEASED
            || id == MOUSE_CLICKED)
        {
<span class="nc bnc" id="L1123" title="All 4 branches missed.">            switch(button) {</span>
            case BUTTON1:
<span class="nc" id="L1125">                modifiers |= BUTTON1_MASK;</span>
<span class="nc" id="L1126">                break;</span>
            case BUTTON2:
<span class="nc" id="L1128">                modifiers |= BUTTON2_MASK;</span>
<span class="nc" id="L1129">                break;</span>
            case BUTTON3:
<span class="nc" id="L1131">                modifiers |= BUTTON3_MASK;</span>
<span class="nc" id="L1132">                break;</span>
            }
        } else {
<span class="nc bnc" id="L1135" title="All 2 branches missed.">            if ((modifiers &amp; BUTTON1_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1136">                modifiers |= BUTTON1_MASK;</span>
            }
<span class="nc bnc" id="L1138" title="All 2 branches missed.">            if ((modifiers &amp; BUTTON2_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1139">                modifiers |= BUTTON2_MASK;</span>
            }
<span class="nc bnc" id="L1141" title="All 2 branches missed.">            if ((modifiers &amp; BUTTON3_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1142">                modifiers |= BUTTON3_MASK;</span>
            }
        }
<span class="nc bnc" id="L1145" title="All 2 branches missed.">        if ((modifiers &amp; ALT_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1146">            modifiers |= ALT_MASK;</span>
        }
<span class="nc bnc" id="L1148" title="All 2 branches missed.">        if ((modifiers &amp; META_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1149">            modifiers |= META_MASK;</span>
        }
<span class="nc bnc" id="L1151" title="All 2 branches missed.">        if ((modifiers &amp; SHIFT_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1152">            modifiers |= SHIFT_MASK;</span>
        }
<span class="nc bnc" id="L1154" title="All 2 branches missed.">        if ((modifiers &amp; CTRL_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1155">            modifiers |= CTRL_MASK;</span>
        }
<span class="nc bnc" id="L1157" title="All 2 branches missed.">        if ((modifiers &amp; ALT_GRAPH_DOWN_MASK) != 0) {</span>
<span class="nc" id="L1158">            modifiers |= ALT_GRAPH_MASK;</span>
        }
<span class="nc" id="L1160">    }</span>

    /**
     * Sets new modifiers by the old ones.
     * @serial
     */
    private void readObject(ObjectInputStream s)
      throws IOException, ClassNotFoundException {
<span class="nc" id="L1168">        s.defaultReadObject();</span>
<span class="nc bnc" id="L1169" title="All 4 branches missed.">        if (getModifiers() != 0 &amp;&amp; getModifiersEx() == 0) {</span>
<span class="nc" id="L1170">            setNewModifiers();</span>
        }
<span class="nc" id="L1172">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>